import{aM as n,az as l,q as d,z as s,bu as u,bk as m}from"./_@vue-AcWbRQZ2.js";import{_ as v}from"../js2/index-A1W57FR6.js";import"./__vendor-oHGn7YgQ.js";const _={data(){return{haveRule:!0,publish:{},total:0,pageSize:10,pageSizeOpts:10,page:1,current_page:1,columns:[{title:"Title",key:"title"},{title:"Content",key:"content"},{title:"Date",key:"create_time",sortable:!0}],data:[]}},created(){if(JSON.parse(sessionStorage.getItem("userinfo")).isAdmin==!0)this.getLiveUpdateLogs();else{let e=this.$router.currentRoute._value.query.menu_id;this.checkAuth(e)}},methods:{async checkAuth(a){let e=this,t=JSON.parse(sessionStorage.getItem("userinfo")).user_id;await e.$api.Admin.checkAuth({id:a,user_id:t}).then(function(i){i.data.code==200?(console.log(i.data.msg),e.haveRule=!0,e.getLiveUpdateLogs()):(console.log(i.data.msg),e.haveRule=!1)}).catch(function(i){console.log(i)})},async getLiveUpdateLogs(){console.log("getLiveUpdateLogs");let a=this,e={page:a.page,pageSize:a.pageSize};await a.$api.LiveUpdateLogs.index(e).then(function(t){t.data.code==200?(a.data=t.data.data.data,a.total=t.data.data.total,a.pageSize=t.data.data.per_page,a.current_page=t.data.data.current_page):t.data.code==210?(a.page=t.data.data.page>1?t.data.data.page-1:1,a.page==1?a.data=[]:a.getLiveUpdateLogs()):console.log(t.data.msg)}).catch(function(t){console.log(t)})},clickSearch(){let a=this,e={page:1,pageSize:10};a.queryLiveUpdateLogs(e)},async queryLiveUpdateLogs(a){let e=this;e.$Message.loading("拼命加载中..."),await e.$api.LiveUpdateLogs.index(a).then(function(t){t.data.code==200?setTimeout(()=>{e.data=t.data.data.data,e.total=t.data.data.total,e.pageSize=t.data.data.per_page,e.current_page=t.data.data.current_page},1e3):(console.log(t.data.msg),e.data=[],e.total=0,e.pageSize=10,e.current_page=1)}).catch(function(t){console.log(t)})},onRefresh(){this.page=1,this.pageSize=10,this.$Message.loading("拼命加载中..."),this.user_id="",setTimeout(()=>{this.getLiveUpdateLogs()},2e3)},changePage(a){var e=this;e.page=a,e.getLiveUpdateLogs()},nextPage(a){var e=this;e.page=a,e.getLiveUpdateLogs()},prevPage(a){var e=this;e.page=a,e.getLiveUpdateLogs()},pageSizeChange(a){var e=this;e.pageSize=a,e.page=1,e.getLiveUpdateLogs()}}},L={key:0},f={key:1};function z(a,e,t,i,o,g){const c=n("Table"),r=n("Page"),p=n("NoAuth");return o.haveRule?(l(),d("div",L,[s(c,{size:"small",columns:o.columns,data:o.data,border:"",style:{margin:"10px"}},null,8,["columns","data"]),u(s(r,{total:o.total,"page-size":o.pageSize,modelValue:o.current_page,"onUpdate:modelValue":e[0]||(e[0]=h=>o.current_page=h),onOnNext:g.nextPage,onOnPrev:g.prevPage,onOnChange:g.changePage,onOnPageSizeChange:g.pageSizeChange,"show-sizer":"","show-total":"","show-elevator":"",style:{margin:"10px"}},null,8,["total","page-size","modelValue","onOnNext","onOnPrev","onOnChange","onOnPageSizeChange"]),[[m,o.total>10]])])):(l(),d("div",f,[s(p)]))}const k=v(_,[["render",z]]);export{k as default};
//# sourceMappingURL=LiveUpdateLogs-RCJ2p3Hf.js.map
