import{_ as G}from"../js2/index-A1W57FR6.js";import{aM as l,az as u,q as g,z as o,bs as i,r as p,y as I,a_ as b,aj as P,F as y,aK as S,o as h,p as H}from"./_@vue-AcWbRQZ2.js";import"./__vendor-oHGn7YgQ.js";const K="/static/gif/img-3G4evXKN.gif",j={data(){return{iconTypes:{0:"md-settings",1:"ios-albums",2:"logo-designernews",3:"ios-send"},tabs:[],tabId:0,imgUrl:K,iconType:"ios-arrow-down",isCollapsed:!1,visible:!1,modalUpdatePassword:!1,loading:!0,activeName:"1-1",openName:["1"],collapsedSiderStatus:!1,menuListLeft:[],tabsList:[],tabName:"",formUpdatePwd:{old_password:"",new_password:"",confirm_new_password:""},ruleValidate:{old_password:[{required:!0,message:"The old password cannot be empty",trigger:"blur"}],new_password:[{required:!0,message:"The new password cannot be empty",trigger:"blur"}],confirm_new_password:[{required:!0,message:"The confirm new password cannot be empty",trigger:"blur"}]},copyright:"Copyright © 2022 View Design All Rights Reserved",userinfo:{},adminIcon:"ios-man-outline"}},created(){let t=sessionStorage.getItem("token");if(t==null||t=="")this.$router.push("/login");else{this.$router.push("/");let e=JSON.parse(sessionStorage.getItem("userinfo"));e&&(this.userinfo=e,e.sex=="男"?this.adminIcon="ios-man-outline":this.adminIcon="ios-woman-outline");let s=sessionStorage.getItem("isMenu");s?this.menuListLeft=JSON.parse(s):this.getMenus()}},updated(){if(sessionStorage.getItem("getData")){sessionStorage.removeItem("getData");let t=this.$route.name;sessionStorage.setItem("getData",JSON.stringify({name:t}))}},computed:{menuListLeft(){return this.$store.state.menu===""?(sessionStorage.removeItem("isMenu"),this.menuListLeft):this.$store.state.menu},rotateIcon(){return["menu-icon",this.isCollapsed?"rotate-icon":""]},menuitemClasses(){return["menu-item",this.isCollapsed?"collapsed-menu":""]}},methods:{async getMenus(){let t=this,e=JSON.parse(sessionStorage.getItem("userinfo")).user_id;await this.$api.Menu.index({is_menu:1,user_id:e}).then(function(s){s.data.code==200&&(t.menuListLeft=s.data.data.data_left,sessionStorage.setItem("isMenu",JSON.stringify(s.data.data.data_left)))}).catch(function(s){console.log(s)})},selectMenu(t,e,s){let d=e+"?menu_id="+s;d in this.tabs?console.log("the tab is exist"):(this.tabs[d]=!0,this.tabsList.push({label:t,name:d})),this.tabName=d,this.$router.push("/"+d)},clickTab(t){console.log(t),this.$router.push("/"+t)},handleTabRemove(t){let e=this.tabsList.findIndex(d=>d.name===t);if(e===-1)return;if(this.tabName===t)if(this.tabsList.length>1){let d=e===this.tabsList.length-1?e-1:e+1;this.tabName=this.tabsList[d].name}else this.tabName="#";this.tabsList.splice(e,1);let s=this.tabs[t];console.log(this.tabName),s&&s.fullPath&&delete this.$router.matched[this.$router.matched.indexOf(s)],delete this.tabs[t],this.clickTab(this.tabName)},openChange(){if(this.activeName="0-0",this.collapsedSiderStatus==!0){this.$refs.side1.toggleCollapse();let t=document.getElementsByClassName("ivu-menu-submenu-title-icon"),e=document.getElementsByClassName("menu");for(let s=0;s<t.length;s++)this.collapsedSiderStatus==!0?(t[s].style.display="block",e[s].style.display="contents"):(t[s].style.display="none",e[s].style.display="none");this.collapsedSiderStatus=this.collapsedSiderStatus!=!0}},collapsedSider(){this.openName=["0"],this.activeName="0-0",this.$nextTick(()=>{this.$refs.menus.updateOpened(),this.$refs.menus.updateActiveName()}),this.$refs.side1.toggleCollapse();let t=document.getElementsByClassName("ivu-menu-submenu-title-icon"),e=document.getElementsByClassName("menu");for(let s=0;s<t.length;s++)this.collapsedSiderStatus==!0?(t[s].style.display="block",e[s].style.display="contents"):(t[s].style.display="none",e[s].style.display="none");this.collapsedSiderStatus=this.collapsedSiderStatus!=!0},onIcon(){this.iconType=this.iconType=="ios-arrow-down"?"ios-arrow-up":"ios-arrow-down"},updatePassword(){this.modalUpdatePassword=!0,this.visible=!1},asyncUpdatePassword(t){console.log(this.loading),this.$refs[t].validate(e=>{e?setTimeout(()=>{this.$Message.success("Success!"),this.modalUpdatePassword=!1},1e3):(this.loading=!1,setTimeout(()=>{this.loading=!0},10))})},cancelModel(t){this.formValidate={},this.$refs[t].resetFields()},logout(){var t=this;sessionStorage.clear(),this.$Message.success("logout success!"),setTimeout(()=>{t.$router.push("/login")},1e3)}}},X={class:"layout"},Q={style:{"margin-left":"15px"}},W={class:"menu"};function Y(t,e,s,d,n,r){const c=l("Icon"),V=l("Divider"),U=l("MenuItem"),k=l("Submenu"),T=l("Menu"),x=l("Sider"),L=l("Notification"),M=l("Avatar"),v=l("Space"),O=l("Poptip"),_=l("Input"),w=l("FormItem"),F=l("Form"),z=l("Modal"),B=l("Header"),E=l("Index"),C=l("TabPane"),D=l("router-view"),R=l("Tabs"),q=l("Content"),J=l("GlobalFooter"),N=l("Layout",!0);return u(),g("div",X,[o(N,null,{default:i(()=>[o(x,{ref:"side1",style:{position:"relative",height:"99vh",left:0,overflow:"auto"},collapsible:"",modelValue:n.isCollapsed,"onUpdate:modelValue":e[0]||(e[0]=a=>n.isCollapsed=a)},{default:i(()=>[p("p",Q,[o(c,{type:n.adminIcon,class:"ios-woman-outline"},null,8,["type"]),I(b(n.userinfo.username),1)]),o(V),o(T,{ref:"menus","active-name":n.activeName,theme:"dark",width:"auto","open-names":n.openName,class:P(r.menuitemClasses),accordion:"",onOnOpenChange:r.openChange},{default:i(()=>[(u(!0),g(y,null,S(r.menuListLeft,(a,f)=>(u(),h(k,{name:f+1,style:{"font-size":"13px"}},{title:i(()=>[o(c,{type:n.iconTypes[f]},null,8,["type"]),p("span",W,b(a.title),1)]),default:i(()=>[(u(!0),g(y,null,S(a.children,(m,A)=>(u(),h(U,{style:{"font-size":"12px"},name:f+1+"-"+(A+1),onClick:Z=>r.selectMenu(m.title,m.controller_name,m.id)},{default:i(()=>[I(b(m.title),1)]),_:2},1032,["name","onClick"]))),256))]),_:2},1032,["name"]))),256))]),_:1},8,["active-name","open-names","class","onOnOpenChange"])]),_:1},8,["modelValue"]),o(N,null,{default:i(()=>[o(B,{style:{padding:0},class:"layout-header-bar"},{default:i(()=>[o(c,{onClick:r.collapsedSider,class:P(r.rotateIcon),style:{margin:"0 20px"},type:"md-menu",size:"24"},null,8,["onClick","class"]),o(v,{size:"large"},{default:i(()=>[o(L,{count:5,style:{"margin-right":"10px"}}),o(v,{size:"large",wrap:""},{default:i(()=>[o(M,{shape:"square",src:n.imgUrl},null,8,["src"])]),_:1}),o(O,{modelValue:n.visible,"onUpdate:modelValue":e[3]||(e[3]=a=>n.visible=a)},{title:i(()=>[p("a",{onClick:e[1]||(e[1]=(...a)=>r.updatePassword&&r.updatePassword(...a))},"update password")]),content:i(()=>[p("a",{onClick:e[2]||(e[2]=(...a)=>r.logout&&r.logout(...a))},"logout")]),default:i(()=>[p("a",null,[o(c,{type:n.iconType,onClick:r.onIcon},null,8,["type","onClick"])])]),_:1},8,["modelValue"])]),_:1}),o(z,{modelValue:n.modalUpdatePassword,"onUpdate:modelValue":e[7]||(e[7]=a=>n.modalUpdatePassword=a),title:"update password",loading:n.loading,onOnOk:e[8]||(e[8]=a=>r.asyncUpdatePassword("formUpdatePwd")),onOnCancel:e[9]||(e[9]=a=>r.cancelModel("formUpdatePwd")),draggable:"true",sticky:"true"},{default:i(()=>[o(F,{ref:"formUpdatePwd",model:n.formUpdatePwd,rules:n.ruleValidate,"label-width":180},{default:i(()=>[o(w,{label:"Old Password",prop:"old_password"},{default:i(()=>[o(_,{modelValue:n.formUpdatePwd.old_password,"onUpdate:modelValue":e[4]||(e[4]=a=>n.formUpdatePwd.old_password=a),placeholder:"Enter Old Password..."},null,8,["modelValue"])]),_:1}),o(w,{label:"New Password",prop:"new_password"},{default:i(()=>[o(_,{modelValue:n.formUpdatePwd.new_password,"onUpdate:modelValue":e[5]||(e[5]=a=>n.formUpdatePwd.new_password=a),placeholder:"Enter New Password..."},null,8,["modelValue"])]),_:1}),o(w,{label:"Confirm New Password",prop:"confirm_new_password"},{default:i(()=>[o(_,{modelValue:n.formUpdatePwd.confirm_new_password,"onUpdate:modelValue":e[6]||(e[6]=a=>n.formUpdatePwd.confirm_new_password=a),placeholder:"Enter Confirm New Password..."},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","loading"])]),_:1}),o(q,{style:{margin:"8px",background:"#fff",minHeight:"260px"}},{default:i(()=>[o(R,{type:"card",ref:"tabs",modelValue:n.tabName,"onUpdate:modelValue":e[10]||(e[10]=a=>n.tabName=a),closable:"",onOnTabRemove:r.handleTabRemove,onOnClick:r.clickTab},{default:i(()=>[o(C,{label:"首页",name:"#",closable:"false"},{default:i(()=>[o(E)]),_:1}),(u(!0),g(y,null,S(n.tabsList,(a,f,m)=>(u(),h(C,{label:a.label,name:a.name},{default:i(()=>[a.name==n.tabName?(u(),h(D,{key:0})):H("",!0)]),_:2},1032,["label","name"]))),256))]),_:1},8,["modelValue","onOnTabRemove","onOnClick"])]),_:1}),o(J,{copyright:n.copyright},null,8,["copyright"])]),_:1})]),_:1})])}const se=G(j,[["render",Y],["__scopeId","data-v-c5baee74"]]);export{se as default};
//# sourceMappingURL=Layout-9wMAqTDN.js.map
