import{_ as y}from"../js2/index-A1W57FR6.js";import{aM as m,az as f,q as c,z as l,bs as a,o as _,y as h,p as S}from"./_@vue-AcWbRQZ2.js";import"./__vendor-oHGn7YgQ.js";const C={data(){return{haveRule:!0,ISAdmin:!1,formCustom:[],ruleCustom:{name:[{validator:(e,s,o)=>{s===""?o(new Error("The name cannot be empty")):o()},trigger:"blur"}]},rules:""}},created(){let t=JSON.parse(sessionStorage.getItem("userinfo")).isAdmin;if(this.ISAdmin=t,t==!0){let e=sessionStorage.getItem("getData");e?JSON.parse(e).name!="admin"&&this.getWebsite():this.getWebsite()}else{let e=this.$router.currentRoute._value.query.menu_id;this.checkAuth(e);let s=sessionStorage.getItem("rules");s?this.rules=s:this.getUserToRules()}},methods:{isSubstring(t,e){return this.ISAdmin==!0?!0:e.split(",").map(o=>parseInt(o.trim())).includes(parseInt(t))},async getUserToRules(){let t=this,e=JSON.parse(sessionStorage.getItem("userinfo")).user_id;await t.$api.Admin.getUserToRules({user_id:e}).then(function(s){s.data.code==200&&(t.rules=s.data.data,sessionStorage.setItem("rules",s.data.data))}).catch(function(s){console.log(s)})},async checkAuth(t){let e=this,s=JSON.parse(sessionStorage.getItem("userinfo")).user_id;await e.$api.Admin.checkAuth({id:t,user_id:s}).then(function(o){o.data.code==200?(e.haveRule=!0,e.getWebsite()):e.haveRule=!1}).catch(function(o){console.log(o)})},async getWebsite(){let t=JSON.parse(sessionStorage.getItem("website"));if(t)this.formCustom=t;else{sessionStorage.setItem("getData",JSON.stringify({name:"admin"}));let e=this;e.$api.Website.getWebsite().then(function(s){s.data.code==200&&(sessionStorage.setItem("website",JSON.stringify(s.data.data)),e.formCustom=JSON.parse(sessionStorage.getItem("website")))}).catch(function(s){e.$Message.error("Network error, request failed"),console.log(s)})}},handleSubmit(t,e){let s=this;s.$refs[t].validate(o=>{o?s.checkIsAuthToButton(e):s.$Message.error("Fail!")})},async saveData(){let t=this;await t.$api.Website.saveWebsite(t.formCustom).then(function(e){e.data.code==200&&(sessionStorage.removeItem("website"),t.$Message.success(e.data.msg),t.getWebsite())}).catch(function(e){t.$Message.error("Network error, request failed"),console.log(e)})},async checkIsAuthToButton(t){let e=this,s=JSON.parse(sessionStorage.getItem("userinfo")).user_id;e.ISAdmin==!1?await e.$api.Admin.checkIsAuthToButton({user_id:s,menu_auth_id:t}).then(function(o){o.data.code==0?e.$Message.error(o.data.msg):e.saveData()}).catch(function(o){console.log(o)}):e.saveData()},handleReset(t){this.$refs[t].resetFields()}}},I={key:0},V={key:1};function W(t,e,s,o,r,d){const u=m("Input"),n=m("FormItem"),p=m("Button"),g=m("Form"),b=m("NoAuth");return r.haveRule?(f(),c("div",I,[l(g,{ref:"formCustom",model:r.formCustom,rules:r.ruleCustom,"label-width":150,style:{width:"99%"}},{default:a(()=>[l(n,{label:"Website Name",prop:"name"},{default:a(()=>[l(u,{modelValue:r.formCustom.name,"onUpdate:modelValue":e[0]||(e[0]=i=>r.formCustom.name=i),type:"text",placeholder:"Enter your Website Name"},null,8,["modelValue"])]),_:1}),l(n,{label:"Website Domain",prop:"url"},{default:a(()=>[l(u,{modelValue:r.formCustom.url,"onUpdate:modelValue":e[1]||(e[1]=i=>r.formCustom.url=i),type:"text",placeholder:"Website Domain"},null,8,["modelValue"])]),_:1}),l(n,{label:"Website Title",prop:"title"},{default:a(()=>[l(u,{modelValue:r.formCustom.title,"onUpdate:modelValue":e[2]||(e[2]=i=>r.formCustom.title=i),type:"textarea",placeholder:"Enter Website Title..."},null,8,["modelValue"])]),_:1}),l(n,{label:"Website Keyword",prop:"keywords"},{default:a(()=>[l(u,{modelValue:r.formCustom.keywords,"onUpdate:modelValue":e[3]||(e[3]=i=>r.formCustom.keywords=i),type:"textarea",placeholder:"Enter Website Keyword..."},null,8,["modelValue"])]),_:1}),l(n,{label:"Website Description",prop:"description"},{default:a(()=>[l(u,{modelValue:r.formCustom.description,"onUpdate:modelValue":e[4]||(e[4]=i=>r.formCustom.description=i),type:"textarea",placeholder:"Enter Website Description..."},null,8,["modelValue"])]),_:1}),l(n,{label:"Website Copyright",prop:"copyright"},{default:a(()=>[l(u,{modelValue:r.formCustom.copyright,"onUpdate:modelValue":e[5]||(e[5]=i=>r.formCustom.copyright=i),type:"textarea",placeholder:"Enter Website Copyright..."},null,8,["modelValue"])]),_:1}),l(n,null,{default:a(()=>[d.isSubstring(247,r.rules)?(f(),_(p,{key:0,type:"primary",size:"default",onClick:e[6]||(e[6]=i=>d.handleSubmit("formCustom",247))},{default:a(()=>[h("Submit")]),_:1})):S("",!0),l(p,{onClick:e[7]||(e[7]=i=>d.handleReset("formCustom")),size:"default",style:{"margin-left":"8px"}},{default:a(()=>[h("Reset")]),_:1})]),_:1})]),_:1},8,["model","rules"])])):(f(),c("div",V,[l(b)]))}const v=y(C,[["render",W]]);export{v as default};
//# sourceMappingURL=Admin-0LDa1mgf.js.map
